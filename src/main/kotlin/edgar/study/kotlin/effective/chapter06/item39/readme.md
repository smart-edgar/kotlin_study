# 아이템39. 태그 클래스보다는 클래스 계층을 사용하라

큰 규모의 프로젝트에서 상수(constant) 모드를 가진 클래스를 꽤 많이 볼 수 있습니다.<br>
이러한 상수 모드를 태그(tag)라고 ㅂ부르며, 태그를 포함한 클래스를 태그 클래스(tagged class)라고 부릅니다.<br>
태그 클래스의 문제는 서로 다른 책임을 한 클래스에 태그로 구분해서 넣는다는 것에서 시작합니다.

[fun01.kt](fun01.kt)
이러한 접근 방법에는 단점이 있습니다.
- 한 클래스에 여러모드를 처리하기 위한 상용구가 추가됩니다.
- 여러 목적으로 사용해야 하므로 프로퍼티가 일관적이지 않게 사용 될 수 있습니다.
- 요소가 여러목적을 가지고 요소를 여러방법으로 설정할 수 있는 경어에는 상태의 일관성과 정확성을 지키기 어렵습니다.
- 팩토리 메서드를 사용해야하는 경우가 많습니다. 그렇지 않으면 객체가 제대로 생성되었는지 확인하는 것 자체가 어렵습니다.

코틀린은 일반적으로 태그 클래스보다 sealed 클래스를 많이 사용합니다.<br>
한 클래스에 여러모드를 만드는 방법 대신에 각각의 모드를 여러 클래스로 만들고 타입 시스템과 다형성을 활용하는 것입니다.<br>
이러한 클래스에는 sealed 한정자를 붙여서 서브클래스 정의를 제한합니다.


## sealed 한정자
sealed 한정자는 외부 파일에서 서브클래스를 만드는 행위 자체를 모두 제한합니다.<br>
외부에서 추가적인 서브 클래스를 만들 수 없으므로 타입이 추가되지 않을 거라는게 보장됩니다.<br>
when을 사용할때 else 브랜치를 따로 만들 필요가 없습니다. 새로운 기능을 쉽게 추가할 수 있으며 when에서 이를 처리하는 것을 잊어버리지 않을 수도 있습니다.

반면 abstract 키워드를 사용하면 다른 개발자가 새로운 인서턴스를 만들어서 사용할 수도 있습니다.<br>
이러한 경우 함수를 abstract로 선언하고 서브클래스 내부에 구현해야 합니다.

sealed 한정자를 사용하면 확장함수를 사용해서 클래스에 새로운 함수를 추가하거나 클래스의 다양한 변경을 쉽게 처리 할 수 있습니다.

클래스의 서브클래스를 제어하려면 sealed 한정자를 사용해야 합니다.<br>
abstract는 상속과 관련된 설계를 할때 사용합니다.


## 태그 클래스와 상태 패턴의 차이
태그 클래스와 상태 패턴을 혼동하면 안됩니다.<br>
상태패턴은 객체의 내부 상태가 변화할때 객체의 동작이 변하는 소프트웨어 디자인 패턴입니다.<br>
상태패턴은 프론트엔드 컨트롤러, 프레젠터, 뷰 모델을 설계할때 많이 사용됩니다.

상태패턴을 사용하면 서로 다른 상태를 나타내는 클래스 계층 구조를 만들게 됩니다.
현재 상태를 나타내기 위한 읽고 쓸 수 있는 프로퍼티도 만들게 됩니다.


여기서 차이점은 다음과 같습니다.
- 상태는 더 많은 책임을 가진 큰 클래스입니다.
- 상태는 변경 할 수 있습니다.

구체 상태는 객체를 활용해서 표현하는 것이 일반적이며, 태그 클래스보다는 sealed 클래스 계층으로 만듭니다.


## 정리
코틀린에서는 태그 클래스보다 타입 계층을 사용하는 것이 좋습니다.
타입계층을 만들때는 sealed 클래스를 사용합니다.

# 아이템27. 변화로부터 코드를 보호하려면 추상화를 사용하라
`물 위를 걷는 것과 명세서로 소프트웨어를 개발하는 것은 쉽다. 둘 다 동결되어 있다면...`<br>

함수와 클래스 등의 추상화로 실질적인 코드를 숨기면, 사용자가 세부 사항을 알지 못해도 괜찮다는 장점이 있습니다.<br>
이후 실질적인 코드(비지니스 코드)를 원하는 대로 수정할 수 있습니다.<br>
예로 정렬 알고리즘을 함수로 추출하면 이 함수를 사용하는 코드에 영향을 주지 않고 함수의 성능을 최적화 할 수 있습니다.


## 상수
상수로 추출하면 변경이 필요할 때 쉽게 변경할 수 있습니다.

장점
- 이름을 붙일 수 있고
- 나중에 해당 값을 쉽게 변경할 수 있습니다.

## 함수
일반적인 알고리즘을 추출하면, (알고리즘 전체) 코드를 항상 기억하지 않아도 괜찮습니다.<br>
또한 수정이 필요할 경우 확장 함수 부분만 수정하면 되므로 유지보수성이 향상됩니다.
의미 있는 이름을 사용해야 한다

## 클래스
클래스는 훨씬 더 많은 자유를 보장해 줍니다.<br>
하지만 여전히 한계가 있습니다.<br>
더 많은 자유를 얻으려면 더 추상적이게 만들면 됩니다.<br>
바로 인터페이스 뒤에 클래스를 숨기는 방법입니다.

## 인터페이스
코틀린 표준 라이브러리를 읽어보면 거의 모든 것이 인터페이스로 표현된다는 것을 확인할 수 있을것입니다.
- listOf 함수는 List를 리턴
- 컬렉션 처리 함수는 Iterable 또는 Collection의 확장 함수로써 List, Map등을 리턴
- 프로퍼티 위임은 ReadOnlyProperty 또는 ReadWriteProperty 뒤에 숨깁니다. 이것들도 모두 인터페이스입니다. 함수 lazy는 Lazy 인터페이스를 리턴 

내부 클래스의 가시성을 제한하고 인터페이스를 통해 이를 노출해 인터페이스만 유지한다면 별도의 걱정 없이 자신이 원하는 형태로 그 구현을 변경 할 수 있습니다.<br>
인터페이스 뒤에 객체를 숨김으로써 실질적인 구현을 추상화하고 사용자가 추상화 된것에만 의존하게 만들수 있는것 입니다.<br>
즉, 결합을 줄일 수 있는 것 입니다.

## ID 만들기(nextId)
응답 타입이 Int로 고정되면 추후 수정하기가 어려움<br>
Id 클래스를 만들어서 응답하면 클래스 내부의 타입은 쉽게 변경할수 있다.

## 추상화가 주는 자유
추상화를 하는 몇가지 방법
- 상수로 추출한다.
- 동작을 함수로 래핑한다.
- 함수를 클래스로 래핑한다
- 인터페이스 뒤에 클래스를 숨긴다.
- 보편적인 객체를 특수한 객체로 래핑한다.

구현할때 여러 도구를 활용
- 제네릭 타입 파라미터를 사용한다.
- 내부 클래스를 추출한다.
- 생성을 제한한다(팩토리 함수로만 객체를 생성 할 수 있게 만드는 등)

## 추상화의 문제
추상화를 하려면 코드를 읽는 사람이 해당 개념을 배우고 잘 이해해야 합니다.<br>
또 다른 방식으로 추상화를 하려면 또 해당 개념을 배우고 잘 이해해야합니다.<br>
큰 프로젝트에서는 잘 모듈화해야합니다.<br>
추상화도 비용이 발생합니다. 따라서 극단적으로 모든 것을 추상화해서는 안됩니다.

`FizzBuzz Enterprise Edition`이라는 프로젝트는 10줄도 필요하지 않은 간단한 문제를 61개 클래스와 26개의 인터페이스로 구현하였고 이는 코드를 이해하는것이 매우 어렵게 되었습니다.<br>

## 어떻게 균형을 맞춰야 할까?
적확한 위치는 다음과 같은 요소들에 따라 달라질수 있습니다.
- 팀의 크기
- 팀의 경험
- 프로젝트의 크기
- 특징 세트(feature set)
- 도메인 지식

균형을 찾을때 사용할수 있는 몇가지 규칙
- 많은 개발자가 참여하는 프로젝트는 이후에 객체 생성과 사용 방법을 변경하기 어렵습니다. 따라서 추상화 방법을 사용하는 것이 좋습니다. 최대한 모듈과 부분(ㅔart)를 분리하는 것이 좋습니다.
- 의존성 주입 프레임워크를 사용하면 생성이 얼마나 복잡한지는 신경 쓰지 않아도 됩니다. 클래스 등은 한번만 정의하면 되기 때문입니다.
- 테스트를 하거나 다른 애플리케이션을 기반으로 새로운 애플리케이션을 만든다면 추상화를 사용하는 것이 좋습니다.
- 프로젝트가 작고 실험적이라면 추상화를 하지 않고도 직접 변경해도 괜찮습니다. 문제가 발생했다면 최대한 빨리 직접 변경하면 됩니다.

## 정리
추상화는 단순하게 중복성을 제거해서 코드를 구성하기 위한것이 아닙니다.<br>
추상화는 코드를 변경해야 할 때 도움이 됩니다.<br>
따라서 추상화는 굉장히 어렵지만 이를 배우고 이해해야 합니다.

# 아이템33. 생성자 대신 팩토리 함수를 사용하라

클라이언트가 클래스의 인스턴스를 만들게 하는 가장 일반적인 방법은 기본 생성자(primary constructor)를 사용하는 방법입니다.<br>
디자인 패턴으로 굉장히 다양한 생성 패턴(creational pattern)들이 만들어져 있습니다.<br>
일반적으로 생성 패턴은 객체를 생성자로 직접 생성하지 않고, 별도의 함수를 통해 생성합니다.<br>

생성자의 역활을 대신 해주는 함수를 <b>팩토리 함수</b>라고 부릅니다.<br>
장점
- 생성자와 다르게 함수에 이름을 붙일 수 있습니다. 이름은 객체가 생성되는 방법과 아규먼트로 무엇이 필요한지 설명할 수 있습니다. 또한 동일한 파라미터 타입을 갖는 생성자의 충돌을 줄일 수 있다는 장점도 있습니다.
- 생성자와 다르게 함수가 원하는 형태의 타입을 리턴할 수 있습니다. 따라서 다른 객체를 생성할 때 사용할 수 있습니다. 인터페이스 뒤에 실제 객체의 구현을 숨길 때 유용하게 사용할 수 있습니다.
- 생성자와 다르게 호출될 때마다 새 객체를 만들 필요가 없습니다.
- 팩토리 함수는 아직 존재하지 않는 객체를 리턴할 수도 있습니다.
- 객체 외부에 팩토리 함수를 만들면 그 가시성을 원하는 대로 제어할 수 있습니다.
- 팩토리 함수는 인라인으로 만들 수 있으며 그 파라미터들을 reified로 만들 수 있습니다.
- 팩토리 함수는 생성자로 만들기 복잡한 객체도 만들어 낼 수 있습니다.
- 생성자는 즉시 슈퍼클래스 또는 기본 생성자를 호출해야 합니다. 하지만 팩토리 함수를 사용하면 원하는 때에 생성자를 호출할 수 있습니다.



## Companion 객체 팩토리 함수
팩토리 함수를 정의하는 가장 일반적인 방법은 companion 객체를 사용하는 것입니다.

이름의 규칙
- from : 파라미터를 하나 받고 같은 타입의 인스턴스 하나를 리턴하는 타입 변환 함수
- of : 파라미터를 여러 개 받고 이를 통합해서 인스턴스를 만들어 주는 함수
- valueOf : from 또는 of와 비슷한 기능을 하면서도 의미를 조금 더 쉽게 읽을 수 있게 이름을 붙인 함수
- instance 또는 getInstance : 싱글턴으로 인스턴스 하나를 리턴하는 함수
- createInstance 또는 newInstance : getInstance 처럼 동작하지만, 싱글턴이 적용되지 않아서 함수를 호출할 때마다 새로운 인스턴스를 만들어서 리턴
- getType : getInstance 처럼 동작하지만 팩토리 함수가 다른 클래스에 있을때 사용하는 이름
- newType : newInstance 처럼 동작하지만 팩토리 함수가 다른 클래스에 있을때 사용하는 이름


## 확장 팩토리 함수
이미 companion 객체가 존재 할 때 이 객체의 함수처럼 사용할 수 있는 팩토리 함수를 만들어야 할 때가 있습니다.<br>
이때 companion 객체를 직접 수정할 수는 없고 다른 파일에 함수를 만들어야 한다면 확장 함수를 활용하면 됩니다.

## 톱레벨 팩토리 함수
객체를 만드는 흔한 방법 중 하나로 톱레벨 팩토리 함수를 이용하는 방법이 있습니다.<br>
대표적으로 listOf, setOf, mapOf가 있습니다.
listOf가 List.of 보다 훨씬 읽기 쉽기 때문에 객체 생성에 톱레벨 함수를 사용한것입니다.

## 가짜 생성자
일반적인 사용의 관점에서 대문자로 시작하는지 아닌지는 생성자와 함수를 구분하는 기준입니다.<br>
물론 함수도 대문자로 시작할 수 있지만, 이는 특수한 다른 용도로서 사용됩니다.<br>

가짜 생성자를 만드는 이유
- 인터페이스를 위한 생성자를 만들고 싶을 때
- reified 타입 아규먼트를 갖게 하고 싶을 때

가짜 생성자는 진짜 생성자처럼 동작해야 합니다.<br>
생성자처럼 보여야 하며 생성자와 같은 동작을 해야합니다.<br>

가짜 생성자를 선언하는 또 다른 방법이 있습니다. invoke 연산자를 갖는 companion 객체를 사용하면 비슷한 결과를 얻을 수 있습니다.
invoke는 호출한다는 의미입니다. 따라서 객체 생성과 의미가 다릅니다.<br>

가짜 생성자는 톱레벨 함수를 사용하는 것이 좋습니다.<br>
기본 생성자를 만들 수 없는 상황 또는 생성자가 제공하지 않는 기능으로 생성자를 만들어야 하는 상황에만 가짜 생성자를 사용하는것이 좋습니다.

## 팩토리 클래스의 메서드
팩토리 클래스와 관련된 추상 팩토리, 프로토타입 등의 수많은 생성 패턴이 있습니다.
팩토리 클래스는 프로퍼티를 가질 수 있습니다.<br>
이를 활용하면 다양한 종류로 최적화 하고 다양한 기능을 도입할 수 있습니다.


## 정리
코틀린은 팩토리 함수를 만들수 있는 다양한 방법들을 제공합니다.<br>
객체를 생성할 때는 각각의 특징을 잘 파악하고 사용해야 합니다.<br>
가짜 생성자, 톱레벨 팩토리 함수, 확장 팩토리 함수 등 일부는 신중하게 사용해야 합니다.<br>
팩토리 함수를 정의하는 가장 일반적인 방법은 companion 객체를 사용하는 것입니다.
